<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Award Ceremony Preview (No Rift / No Swap)</title>
  <style>
    :root{
      --bg:#070A12;
      --ink:#EAF2FF;
      --muted:#98A2B3;

      --c1:#23f3ff;   /* cyan */
      --c2:#a855ff;   /* purple */
      --c3:#ff3df2;   /* magenta */
      --border: rgba(234,242,255,.12);
    }

    body{
      margin:0;
      background: radial-gradient(1200px 700px at 50% 10%, rgba(168,85,255,.15), transparent 60%),
                  radial-gradient(900px 500px at 70% 85%, rgba(35,243,255,.10), transparent 60%),
                  var(--bg);
      color:var(--ink);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* ===== Preview UI ===== */
    .wrap{ max-width:1000px; margin:28px auto; padding:0 16px; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    button{
      padding:10px 14px; border-radius:12px;
      border:1px solid rgba(234,242,255,.18);
      background: rgba(255,255,255,.06);
      color:var(--ink); font-weight:800; cursor:pointer;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    button:hover{ border-color: rgba(35,243,255,.35); }
    .pill{
      padding:8px 12px; border-radius:999px;
      border:1px solid rgba(234,242,255,.12);
      background: rgba(255,255,255,.04);
      color: rgba(234,242,255,.72);
      font-size:12px;
    }

    /* =========================================================
       AWARD CEREMONY OVERLAY (NEW) — NO RIFT, NO SWAP
       ========================================================= */
    #award{
      position:fixed; inset:0; z-index:9999;
      display:grid; place-items:center;
      opacity:0; pointer-events:none;
      transition: opacity .22s ease;
    }
    #award.is-open{ opacity:1; pointer-events:auto; }

    .veil{
      position:absolute; inset:0;
      background: radial-gradient(900px 500px at 50% 35%, rgba(0,0,0,.22), rgba(0,0,0,.82));
      opacity:0;
    }
    #award.is-open .veil{ animation: veilIn .32s ease forwards; }
    @keyframes veilIn{ to{ opacity:1; } }

    .grain{
      position:absolute; inset:-20%;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:0;
      pointer-events:none;
    }
    #award.is-open .grain{ animation: grainIn .32s ease .05s forwards; }
    @keyframes grainIn{ to{ opacity:.16; } }

    .stage{
      position:relative;
      width:min(860px, 92vw);
      height:min(520px, 76vh);
      border-radius:28px;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      border:1px solid var(--border);
      box-shadow: 0 40px 130px rgba(0,0,0,.55);
      opacity:0;
      transform: translateY(14px) scale(.985);
      will-change: transform, opacity, filter;
    }
    #award.is-open .stage{ animation: stageIn .55s cubic-bezier(.2,.9,.2,1) .05s forwards; }
    @keyframes stageIn{
      to{ opacity:1; transform: translateY(0) scale(1); }
    }

    /* subtle scanlines */
    .scan{
      position:absolute; inset:0;
      background:
        linear-gradient(90deg, rgba(35,243,255,.08), transparent 40%),
        repeating-linear-gradient(180deg, rgba(234,242,255,.08) 0, rgba(234,242,255,.08) 1px, transparent 1px, transparent 7px);
      opacity:.30;
      mix-blend-mode: screen;
      animation: scanMove 3.2s linear infinite;
      pointer-events:none;
    }
    @keyframes scanMove{ to{ background-position: 220px 0, 0 140px; } }

    /* HUD */
    .hud{
      position:absolute; left:24px; right:24px; top:20px;
      display:flex; align-items:flex-start; justify-content:space-between;
      pointer-events:none;
      opacity:.92;
    }
    .kicker{
      font-size:14px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:rgba(234,242,255,.85);
    }
    .sub{
      margin-top:8px;
      font-size:12px;
      color:rgba(152,162,179,.9);
      letter-spacing:.06em;
      max-width: 520px;
    }
    .right{
      text-align:right;
      font-size:12px;
      color:rgba(234,242,255,.72);
      letter-spacing:.1em;
      text-transform:uppercase;
    }

    /* Center group */
    .center{
      position:absolute; inset:0;
      display:grid; place-items:center;
      pointer-events:none;
    }

    /* FX: halo + sigil */
    .evoHalo, .evoSigil{
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%) scale(.92);
      width: min(540px, 78vmin);
      height: min(540px, 78vmin);
      border-radius: 999px;
      opacity:0;
      pointer-events:none;
      mix-blend-mode: screen;
      will-change: transform, opacity, filter;
    }

    .evoHalo{
      background:
        radial-gradient(closest-side, rgba(35,243,255,.12), transparent 62%),
        radial-gradient(closest-side, rgba(168,85,255,.10), transparent 68%),
        conic-gradient(from 0deg,
          rgba(35,243,255,0) 0deg,
          rgba(35,243,255,.22) 30deg,
          rgba(168,85,255,0) 95deg,
          rgba(255,61,242,.18) 140deg,
          rgba(35,243,255,0) 220deg,
          rgba(168,85,255,.16) 280deg,
          rgba(35,243,255,0) 360deg
        );
      filter: blur(10px);
    }

    .evoSigil{
      background:
        radial-gradient(circle at 50% 50%, transparent 56%, rgba(234,242,255,.14) 57%, transparent 58%),
        radial-gradient(circle at 50% 50%, transparent 66%, rgba(35,243,255,.18) 67%, transparent 68%),
        repeating-conic-gradient(from 0deg,
          rgba(35,243,255,0) 0 10deg,
          rgba(35,243,255,.18) 10deg 12deg,
          rgba(35,243,255,0) 12deg 28deg
        );
      filter: blur(.2px);
    }

    /* Flash burst on impact */
    .burst{
      position:absolute; inset:-30%;
      background:
        radial-gradient(closest-side at 50% 50%, rgba(255,255,255,.22), transparent 60%),
        radial-gradient(closest-side at 50% 50%, rgba(35,243,255,.18), transparent 70%),
        radial-gradient(closest-side at 50% 50%, rgba(168,85,255,.16), transparent 75%);
      opacity:0;
      transform: scale(.75);
      mix-blend-mode: screen;
      pointer-events:none;
      will-change: transform, opacity;
    }

    /* Badge card */
    .badgeWrap{
      position:relative;
      width: 250px; height: 250px;
      border-radius: 28px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid rgba(234,242,255,.14);
      backdrop-filter: blur(6px);
      display:grid; place-items:center;
      box-shadow: 0 30px 80px rgba(0,0,0,.35);
      opacity:0;
      transform: translateY(10px) scale(.98);
      will-change: transform, opacity, filter;
    }

    /* Your rank icon */
    .badgeImg{
      width: 190px; height: 190px;
      object-fit: contain;
      image-rendering: auto;
      filter: drop-shadow(0 0 16px rgba(35,243,255,.18));
    }

    /* Tier dots (3 segments) */
    .tierDots{
      position:absolute;
      left:50%;
      top: calc(50% + 182px);
      transform: translateX(-50%);
      display:flex;
      gap:10px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(234,242,255,.12);
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(6px);
      opacity:0;
      pointer-events:none;
      will-change: transform, opacity;
    }
    .tierDot{
      width:10px; height:10px; border-radius:999px;
      background: rgba(234,242,255,.12);
      transform: translateY(0) scale(1);
      will-change: transform, opacity, box-shadow;
    }
    .tierDot.is-on{
      background: rgba(35,243,255,.65);
      box-shadow: 0 0 10px rgba(35,243,255,.35), 0 0 22px rgba(168,85,255,.18);
    }
    .tierDot.is-justOn{
      animation: tdPing .7s cubic-bezier(.2,.95,.2,1) forwards;
    }
    @keyframes tdPing{
      0%{ transform: translateY(0) scale(.9); box-shadow:none; }
      40%{ transform: translateY(-2px) scale(1.35);
           box-shadow: 0 0 12px rgba(35,243,255,.55), 0 0 26px rgba(168,85,255,.22); }
      100%{ transform: translateY(0) scale(1);
            box-shadow: 0 0 10px rgba(35,243,255,.35), 0 0 22px rgba(168,85,255,.18); }
    }

    /* Stamp text */
    .stamp{
      position:absolute;
      left:50%;
      top: calc(50% + 235px);
      transform: translateX(-50%) translateY(10px);
      text-align:center;
      pointer-events:none;
      opacity:0;
      will-change: transform, opacity;
    }
    .stampTop{
      font-size:12px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color: rgba(234,242,255,.82);
    }
    .stampName{
      margin-top:8px;
      font-size:22px;
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(234,242,255,.92);
      text-shadow: 0 0 16px rgba(35,243,255,.22);
    }

    /* =========================================================
       PHASES (open → impact → reveal → done)
       ========================================================= */

    /* OPEN: pre-charge (halo appears, badge comes in gently) */
    #award[data-phase="open"] .evoHalo{
      animation: haloOpen 900ms cubic-bezier(.2,.9,.2,1) forwards;
    }
    @keyframes haloOpen{
      0%{ opacity:0; transform: translate(-50%,-50%) scale(.86); }
      100%{ opacity:.22; transform: translate(-50%,-50%) scale(.98); }
    }

    #award[data-phase="open"] .badgeWrap{
  animation: badgeIn 700ms cubic-bezier(.2,.9,.2,1) forwards;
}
    @keyframes badgeIn{
      0%{ opacity:0; transform: translateY(14px) scale(.98); }
      100%{ opacity:1; transform: translateY(0) scale(1); }
    }

    /* IMPACT: hero moment (flash + micro zoom + halo burst + sigil pop) */
    #award[data-phase="impact"] .burst{
      animation: burst 520ms ease forwards;
    }
    @keyframes burst{
      0%{ opacity:0; transform: scale(.75); }
      35%{ opacity:1; transform: scale(1); }
      100%{ opacity:0; transform: scale(1.12); }
    }

    #award[data-phase="impact"] .stage{
      animation: impactStage 300ms ease forwards;
    }
    @keyframes impactStage{
      0%{ transform: translateY(0) scale(1); filter:none; }
      25%{ transform: translateY(-1px) translateX(1px) scale(1.01); filter: brightness(1.07); }
      55%{ transform: translateY(1px) translateX(-1px) scale(1.008); filter: brightness(1.03); }
      100%{ transform: translateY(0) translateX(0) scale(1); filter:none; }
    }

    #award[data-phase="impact"] .evoHalo{
      animation: haloImpact 560ms ease forwards;
    }
    @keyframes haloImpact{
      0%{ opacity:.22; transform: translate(-50%,-50%) scale(.98); filter: blur(10px); }
      35%{ opacity:.95; transform: translate(-50%,-50%) scale(1.06) rotate(8deg); filter: blur(8px); }
      100%{ opacity:.30; transform: translate(-50%,-50%) scale(1.02) rotate(0deg); filter: blur(10px); }
    }

    #award[data-phase="impact"] .evoSigil{
      animation: sigilImpact 560ms ease forwards;
    }
    @keyframes sigilImpact{
      0%{ opacity:0; transform: translate(-50%,-50%) scale(.92); }
      35%{ opacity:.85; transform: translate(-50%,-50%) scale(1.03); }
      100%{ opacity:.16; transform: translate(-50%,-50%) scale(1.02); }
    }

    /* REVEAL: badge “becomes a reward” (overshoot + settle) + stamp appears */
    #award[data-phase="reveal"] .badgeWrap{
      animation: badgeReveal 1150ms cubic-bezier(.12,.95,.18,1) forwards;
    }
    @keyframes badgeReveal{
  0%{
    opacity:1;
    transform: translateY(0) scale(1);
    filter: drop-shadow(0 0 18px rgba(35,243,255,.18));
  }
  45%{
    transform: translateY(-8px) scale(1.08);
    filter: drop-shadow(0 0 30px rgba(35,243,255,.24));
  }
  100%{
    transform: translateY(0) scale(1);
    filter: drop-shadow(0 0 18px rgba(35,243,255,.18));
  }
}

    #award[data-phase="reveal"] .stamp{
      animation: stampIn 820ms cubic-bezier(.2,.9,.2,1) 140ms forwards;
    }
    @keyframes stampIn{
      0%{ opacity:0; transform: translateX(-50%) translateY(14px); }
      100%{ opacity:1; transform: translateX(-50%) translateY(0); }
    }

    /* DONE: show tier dots + subtle afterglow breathing */
    #award[data-phase="done"] .tierDots{
      opacity:1;
      transform: translateX(-50%) translateY(0);
    }

    #award[data-phase="done"] .badgeWrap{
      animation: afterglow 2400ms ease-in-out infinite;
    }
    @keyframes afterglow{
      0%,100%{ filter: drop-shadow(0 0 10px rgba(35,243,255,.14)); }
      50%{ filter: drop-shadow(0 0 22px rgba(168,85,255,.18)); }
    }

    #award[data-phase="done"] .evoHalo{
      opacity:.18;
      transform: translate(-50%,-50%) scale(1.02);
    }

    /* Hide tierDots for top rank */
    #award.is-top .tierDots{ display:none; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .scan,.evoHalo,.evoSigil,.grain{ animation:none !important; }
      #award[data-phase="open"] .badgeWrap,
      #award[data-phase="impact"] .burst,
      #award[data-phase="impact"] .stage,
      #award[data-phase="impact"] .evoHalo,
      #award[data-phase="impact"] .evoSigil,
      #award[data-phase="reveal"] .badgeWrap,
      #award[data-phase="reveal"] .stamp,
      #award[data-phase="done"] .badgeWrap{
        animation:none !important;
      }
      #award.is-open{ opacity:1; }
      .stage{ opacity:1; transform:none; }
      .badgeWrap{ opacity:1; transform:none; filter:none; }
      .tierDots{ opacity:1; transform: translateX(-50%); }
      .stamp{ opacity:1; transform: translateX(-50%); }
    }
    /* === Make ceremony FULLSCREEN (remove big glass window) === */
.stage{
  width: 100vw !important;
  height: 100vh !important;
  border-radius: 0 !important;
  border: none !important;
  box-shadow: none !important;
  background: transparent !important;
  overflow: visible !important;
  transform: none !important;
  opacity: 1 !important;
}

/* Hud stays, but a bit more “floating” */
.hud{
  top: 26px !important;
  left: 34px !important;
  right: 34px !important;
  opacity: .95 !important;
}

/* Scanlines across full screen */
.scan{
  opacity: .22 !important;
}
    /* Ensure badge never appears as “empty window” */
#award.is-open .badgeWrap{ opacity: 1 !important; }
    
  </style>
</head>
<body>
  <div class="wrap">
    <h2>Award Ceremony Preview (clean)</h2>
    <div class="row">
      <button id="btnTierUp">Tier Up (III→II→I)</button>
      <button id="btnRankUp">Rank Up</button>
      <button id="btnTop">Top Rank (EIDOLON)</button>
      <button id="btnClose">Close</button>
      <span class="pill">auto-close • no rift • no swap</span>
    </div>
    <p style="opacity:.78;margin-top:14px;line-height:1.45">
      Натискай кнопки і дивись “як у грі”. Коли буде вау — переносимо 1:1 в index.html.
    </p>
  </div>

  <!-- ===== Award overlay (new, standalone) ===== -->
  <div id="award" aria-hidden="true">
    <div class="veil"></div>
    <div class="grain" aria-hidden="true"></div>

    <div class="stage" role="dialog" aria-label="Award ceremony">
      <div class="scan" aria-hidden="true"></div>
      <div class="burst" aria-hidden="true"></div>

      <header class="hud">
        <div>
          <div class="kicker">RANKED UPDATE</div>
          <div class="sub" id="subText">Award Ceremony • Preparing…</div>
        </div>
        <div class="right" id="rightText">AUTO</div>
      </header>

      <div class="center">
        <div class="evoHalo" aria-hidden="true"></div>
        <div class="evoSigil" aria-hidden="true"></div>

        <div class="badgeWrap" id="badgeWrap">
          <!-- Put your real icon path here -->
          <img class="badgeImg" id="rankIcon" alt="Rank icon" src="assets/ranks/eidolon.webp">
        </div>

        <div class="tierDots" id="tierDots" aria-hidden="true">
          <span class="tierDot" data-i="0"></span>
          <span class="tierDot" data-i="1"></span>
          <span class="tierDot" data-i="2"></span>
        </div>

        <div class="stamp" aria-hidden="true">
          <div class="stampTop" id="stampTop">NEW RANK</div>
          <div class="stampName" id="stampName">EIDOLON</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const award = document.getElementById('award');
    const subText = document.getElementById('subText');
    const rightText = document.getElementById('rightText');
    const stampTop = document.getElementById('stampTop');
    const stampName = document.getElementById('stampName');
    const rankIcon = document.getElementById('rankIcon');

    let timers = [];
    const clearTimers = ()=>{ timers.forEach(t=>clearTimeout(t)); timers=[]; };

    // WebAudio micro SFX (no files needed). Works when triggered by button click.
    let audioCtx = null;
    function beep(type='up'){
      try{
        if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const t0 = audioCtx.currentTime;
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'sine';

        const base = (type==='impact') ? 220 : (type==='up' ? 520 : 300);
        o.frequency.setValueAtTime(base, t0);
        o.frequency.exponentialRampToValueAtTime(base * (type==='impact' ? 3.2 : 1.6), t0 + 0.08);

        g.gain.setValueAtTime(0.0001, t0);
        g.gain.exponentialRampToValueAtTime(type==='impact' ? 0.12 : 0.08, t0 + 0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.18);

        o.connect(g); g.connect(audioCtx.destination);
        o.start(t0);
        o.stop(t0 + 0.22);
      }catch(e){}
    }

    function setPhase(p){ award.dataset.phase = p; }

    function openOverlay(){
      clearTimers();
      award.classList.add('is-open');
      award.setAttribute('aria-hidden','false');
    }
    function closeOverlay(){
      clearTimers();
      award.classList.remove('is-open','is-top');
      award.removeAttribute('data-phase');
      award.setAttribute('aria-hidden','true');
    }

    function setTier(divIndex){
      const dots = [...document.querySelectorAll('#tierDots .tierDot')];
      dots.forEach((d,i)=>{
        d.classList.toggle('is-on', i <= divIndex);
        d.classList.remove('is-justOn');
      });
      const just = document.querySelector(`#tierDots .tierDot[data-i="${divIndex}"]`);
      if(just) just.classList.add('is-justOn');
      timers.push(setTimeout(()=>{ if(just) just.classList.remove('is-justOn'); }, 720));
    }

    // Core ceremony (open → impact → reveal → done → auto close)
    function playAward({rankName, iconSrc, isTop=false, divIndex=2, mode='rankUp'}){
      openOverlay();

      award.classList.toggle('is-top', !!isTop);

      stampName.textContent = rankName;
      stampTop.textContent = (mode === 'tierUp') ? 'DIVISION UP' : 'NEW RANK';
      rightText.textContent = 'AUTO';
      subText.textContent = (mode === 'tierUp')
        ? 'Division update • Confirmed.'
        : 'Award Ceremony • Promotion confirmed.';

      if(iconSrc) rankIcon.src = iconSrc;

      if(!isTop){
        setTier(divIndex);
      }

      // Timeline tuned for “award feel”
      setPhase('open');

      // Impact: 200–300ms hero moment
      timers.push(setTimeout(()=>{
        setPhase('impact');
        beep('impact');
      }, mode === 'tierUp' ? 520 : 1050));

      // Reveal: badge becomes reward
      timers.push(setTimeout(()=>{
        setPhase('reveal');
        beep('up');
      }, mode === 'tierUp' ? 720 : 1300));

      // Done: hold (top rank holds a bit longer)
      timers.push(setTimeout(()=>{
        setPhase('done');
      }, mode === 'tierUp' ? 1100 : 2300));

      const holdMs = isTop ? 2600 : 1800; // from done to close
      timers.push(setTimeout(()=>closeOverlay(), (mode === 'tierUp' ? 1100 : 2300) + holdMs));
    }

    // Buttons
    let divIndex = 0; // III→II→I as 0→1→2
    document.getElementById('btnTierUp').addEventListener('click', ()=>{
      divIndex = Math.min(2, divIndex + 1);
      playAward({
        rankName: 'MARAUDER',
        iconSrc: 'assets/ranks/marauder.webp', // replace with real path
        isTop: false,
        divIndex,
        mode: 'tierUp'
      });
    });

    document.getElementById('btnRankUp').addEventListener('click', ()=>{
      divIndex = 0;
      playAward({
        rankName: 'REAPER',
        iconSrc: 'assets/ranks/reaper.webp', // replace with real path
        isTop: false,
        divIndex,
        mode: 'rankUp'
      });
    });

    document.getElementById('btnTop').addEventListener('click', ()=>{
      playAward({
        rankName: 'EIDOLON',
        iconSrc: 'assets/ranks/eidolon.webp', // replace with real path
        isTop: true,
        divIndex: null,
        mode: 'rankUp'
      });
    });

    document.getElementById('btnClose').addEventListener('click', closeOverlay);

    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape' && award.classList.contains('is-open')) closeOverlay();
    });
  </script>
</body>
</html>
